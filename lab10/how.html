<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>steak!!</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <a href="what.html">What is it?</a>
        <a href="why.html">Why is it important?</a>
        <a href="how.html">How is it used?</a>
        <a href="source.html">Sources</a>
    </div>

    <span style="font-size:20px;cursor:pointer" onclick="openNav()">&#9776; open</span>

    <div id="main">
        <header>
            <h1>
                How is it used?
            </h1>
        </header>
        <main>
            <article>
                <img src="image/wca.png" alt="Web Cryptography API picture" width="400">
                <h3>Description</h3>
                <p> The Web Cryptography API is used to perform cryptographic operations in many cases in web applications. The WCA provides secure ways to encrypt and decrypt data and hash passwords and files. It is also used for digital signatures, verifying,
                    and generating keys in a way that’s built directly into the browser. W3C provides some examples of these use cases.
                </p>
                <h3>Examples</h3>
                <p> Here are some examples:
                </p>
                <ul>
                    <li><strong>Example 1 – generating asymmetric keys</strong> <br></br>
                        “// Algorithm Object <br></br>
                        var algorithmKeyGen = { <br></br>
                        name: "RSASSA-PKCS1-v1_5", <br></br>
                        // RsaKeyGenParams <br></br>
                        params: { <br></br>
                        modulusLength: 2048, <br></br>
                        publicExponent: new Uint8Array([0x01, 0x00, 0x01]), // Equivalent to 65537 <br></br>
                        } <br></br>
                        }; <br></br>


                        window.crypto.subtle.generateKey(algorithmKeyGen, false, ["sign"]).then( <br></br>
                        function(keyPair) <br></br>
                        { <br></br>
                        // Store the key pair in IndexedDB <br></br>
                        }, <br></br>
                        console.error.bind(console, "Unable to generate keys -- call your Banker or retry later."));” <br></br>
                    </li>
                    <li><strong>Example 2 – veifying digital signature and decrypting</strong><br></br>

                        “// Encrypted and Signed Message generated by GB... the ellipsis are added. <br></br>
                        // This could be in a parsable JWT format such that portions with signature and message are easily understood<br></br>

                        var cat = "qANQR1DBw04Dk2uPpEjcJT8QD/0VCfFK2XDM5Cg4iTRwmXrB+Pp8SMK5x09WkYqc... ";<br></br>

                        /** <br></br>
                        1. Generate an ArrayBufferView of the overall message.<br></br>
                        2. Bit-manipulate this with the ArrayBufferView API to obtain the portion of bytes<br></br>
                        constituting the signature as an ArrayBufferView, and the message as an ArrayBufferView.<br></br>
                        This could use JWT objects.<br></br>
                        3. Obtain the public key of GB from IndexedDB -- pubGBKeySign -- a step not shown here.<br></br>
                        4. Verify the signature.<br></br>
                        5. Upon verification, decrypt the message. This message can be decrypted only by Jae-Sang, using his private key <br></br>

                        **/<br></br>

                        var data = createArrayBufferView(cat);<br></br>
                        var signature = extractSignature(data);<br></br>
                        var pMessage = extractMessage(data);<br></br>
                        var mRSARFC3447 = {<br></br>
                        name: "RSASSA-PKCS1-v1_5", params: {<br></br>
                        hash: "SHA-256"<br></br>
                        }<br></br>
                        };<br></br>
                        // Verify GB signature<br></br>
                        window.crypto.subtle.verify(mRSARFC3447, pubGBKeySign, signature).then(<br></br>
                        function(verified){<br></br>

                        /*”<br></br>
                        If verified, obtain a prvKeyEncrypt from IndexedDB representing Jae-sang's private key and:<br></br>
                        1. Decrypt the message. Note that here, typically the encryption key might be symmetric<br></br>
                        and wrapped. This sample simplifies this by not demonstrating key wrapping.<br></br>
                        2. Do further operations, like sign the decrypted message and send it back<br></br>
                        Else the signature is invalid -- abort<br></br>
                        */<br></br>

                        return window.crypto.subtle.decrypt("RSAES-PKCS1-v1_5", prvKeyEncrypt, pMessage);<br></br>

                        },<br></br>
                        console.log.bind(console, "Verification Error! Contact Bank.")).then(<br></br>
                        function decrypted(message){<br></br>

                        // Conduct operations on GB message<br></br>
                        // This could include signing the decrypted message and sending it back to GB<br></br>

                        },<br></br>
                        console.error.bind(console, "Decryption Error! Contact Bank.")<br></br>

                        );<br></br>

                    </li>
                </ul>
            </article>
        </main>
        <footer>
            <p>© 2024 Kaden Duong in CSIT 121</p>
        </footer>
    </div>
    <script>
        function openNav() {
            document.getElementById("mySidenav").style.width = "250px";
            document.getElementById("main").style.marginLeft = "250px";
        }

        function closeNav() {
            document.getElementById("mySidenav").style.width = "0";
            document.getElementById("main").style.marginLeft = "0";
        }
    </script>
</body>

</html>